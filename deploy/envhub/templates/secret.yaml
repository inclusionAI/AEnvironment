# 为 envhub namespace 创建 OSS secret
apiVersion: v1
kind: Secret
metadata:
  name: oss-secret
  namespace: {{ .Values.global.namespace }}
type: Opaque
data:
  # OSS credentials (base64 encoded)
  {{- if .Values.oss.accessKeyId }}
  oss-ak: {{ .Values.oss.accessKeyId | b64enc | quote }}
  {{- else }}
  oss-ak: ""
  {{- end }}
  {{- if .Values.oss.accessKeySecret }}
  oss-sk: {{ .Values.oss.accessKeySecret | b64enc | quote }}
  {{- else }}
  oss-sk: ""
  {{- end }}
  {{- if .Values.oss.endpoint }}
  oss-endpoint: {{ .Values.oss.endpoint | b64enc | quote }}
  {{- else }}
  oss-endpoint: ""
  {{- end }}
  {{- if .Values.oss.bucket }}
  oss-bucket: {{ .Values.oss.bucket | b64enc | quote }}
  {{- else }}
  oss-bucket: ""
  {{- end }}
---
# 为 aenv-sandbox namespace 创建相同的 OSS secret
# 用于 service pod 访问 OSS
apiVersion: v1
kind: Secret
metadata:
  name: oss-secret
  namespace: {{ .Values.global.sandboxNamespace }}
type: Opaque
data:
  # OSS credentials (base64 encoded)
  {{- if .Values.oss.accessKeyId }}
  oss-ak: {{ .Values.oss.accessKeyId | b64enc | quote }}
  {{- else }}
  oss-ak: ""
  {{- end }}
  {{- if .Values.oss.accessKeySecret }}
  oss-sk: {{ .Values.oss.accessKeySecret | b64enc | quote }}
  {{- else }}
  oss-sk: ""
  {{- end }}
  {{- if .Values.oss.endpoint }}
  oss-endpoint: {{ .Values.oss.endpoint | b64enc | quote }}
  {{- else }}
  oss-endpoint: ""
  {{- end }}
  {{- if .Values.oss.bucket }}
  oss-bucket: {{ .Values.oss.bucket | b64enc | quote }}
  {{- else }}
  oss-bucket: ""
  {{- end }}
