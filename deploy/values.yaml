# Default values for AEnv Platform umbrella chart
# This file contains default values for all sub-charts

# Global settings
global:
  namespace: aenv
  createNamespace: true

# Controller component
controller:
  enabled: true
  replicaCount: 1
  name: controller
  metadata:
    namespace: aenv
  sandboxNamespace: aenvsandbox
  namespace:
    create: true
  image: aenvironment/controller:0.1.0
  service:
    type: LoadBalancer
    port: 8080
  resources:
    limits:
      cpu: "2"
      memory: "4G"
      ephemeral-storage: 10Gi
    requests:
      cpu: "0"
      memory: "0"
      ephemeral-storage: 10Gi

# Redis component - Using Bitnami Redis Chart with Sentinel mode
redis:
  enabled: true
  # Configuration is in redis/values.yaml
  # Sentinel mode is enabled by default with minimal configuration

# EnvHub component
envhub:
  enabled: true
  replicaCount: 1
  name: envhub
  metadata:
    namespace: aenv
  namespace:
    create: false
  image: aenvironment/envhub:0.1.0
  service:
    type: LoadBalancer
    port: 8083
    metricsPort: 9091
  resources:
    limits:
      cpu: "1"
      memory: "512Mi"
      ephemeral-storage: 1Gi
    requests:
      cpu: "1"
      memory: "512Mi"
      ephemeral-storage: 1Gi
  # Redis configuration for EnvHub
  redis:
    # Connection mode: "direct" or "sentinel"
    # - "direct": Connect directly to Redis master
    # - "sentinel": Use Sentinel mode for automatic failover (default, recommended for production)
    mode: "sentinel"  # Default: "sentinel" for high availability
    
    # Direct connection mode: Redis connection address (only used when mode is "direct")
    addr: ""
    
    # Sentinel mode: Number of Sentinel replicas (should match redis.sentinel.replicaCount)
    # Used to auto-generate sentinelAddrs if sentinelAddrs is empty
    sentinelReplicaCount: 3  # Should match redis/values.yaml sentinel.replicaCount
    # Sentinel mode: Comma-separated Sentinel addresses
    # If empty, will auto-generate based on sentinelReplicaCount
    # Format: "redis-sentinel-0.redis-sentinel-headless.aenv.svc.cluster.local:26379,..."
    sentinelAddrs: ""  # Leave empty to auto-generate based on sentinelReplicaCount
    # Sentinel mode: Master name (default: "mymaster")
    masterName: "mymaster"
    
    keyPrefix: "env"
    username: ""
    password: ""
    db: 0

# API Service component
api-service:
  enabled: true
  replicaCount: 1
  name: api-service
  metadata:
    namespace: aenv
  namespace:
    create: false
  image: aenvironment/api-service:0.1.0
  service:
    type: LoadBalancer
    port: 8080
    mcpProxyPort: 8081
  resources:
    limits:
      cpu: "2"
      memory: "4G"
      ephemeral-storage: 10Gi
    requests:
      cpu: "0"
      memory: "0"
      ephemeral-storage: 10Gi
